(this["webpackJsonpchess-game"]=this["webpackJsonpchess-game"]||[]).push([[0],{21:function(e,t,a){e.exports=a(46)},26:function(e,t,a){},27:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(13),o=a.n(s),i=(a(26),a(19)),c=a(2),l=a(14),u=a(15),h=a(20),m=a(18),d=(a(27),a(50)),p=a(49),v=a(16),y=a.n(v),f=a(28),g=a(41),b=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).get_piece_positions=function(e){var t;return(t=[]).concat.apply(t,Object(c.a)(n.chess.board())).map((function(t,a){if(null!==t&&t.type===e.type&&t.color===e.color)return a})).filter(Number.isInteger).map((function(e){return"abcdefgh"[e%8]+Math.ceil((64-e)/8)}))},n.boardStyle={display:"inline-block",boxShadow:"0.5vw 1vh 3vw rgba(0,0,0,0.5)",margin:"0 auto 0 auto"},n.sidePanelStyles={},n.undoMove=function(){n.chess.undo();var e=n.updateInCheckStyles(),t=Object(c.a)(n.state.blackHistory),a=Object(c.a)(n.state.whiteHistory);"b"===n.chess.turn()?t.pop():a.pop(),n.setState({currentState:n.chess.fen(),squareStyles:e,gameOverDisplay:n.chess.game_over(),blackHistory:t,whiteHistory:a})},n.prepareHistory=function(){var e=[],t=Object(c.a)(n.state.whiteHistory),a=Object(c.a)(n.state.blackHistory);a.length<t.length&&a.push("");for(var r=0;r<t.length;r++){var s=[r+1,t[r],a[r]];e.push(s)}return e},n.newGame=function(e){n.chess=new g,n.previousClickedSqure="",n.setState({currentState:n.chess.fen(),welcomeDisplay:!1,againstAI:e,whiteHistory:[],blackHistory:[]})},n.displayHomeScreen=function(){n.setState({welcomeDisplay:!0})},n.calcWidth=function(e){var t=e.screenWidth,a=e.screenHeight;return t>a?.8*a:.8*t},n.onDrop=function(e){var t=e.sourceSquare,a=e.targetSquare;null!==n.chess.move({from:t,to:a,promotion:"q"})&&(n.state.againstAI?n.aiMakeMove():n.updateMoveHistory())},n.updateMoveHistory=function(){var e=n.updateInCheckStyles();switch(n.chess.turn()){case"b":var t=Object(c.a)(n.state.whiteHistory);t.push(n.chess.history()[n.chess.history().length-1]),n.setState({currentState:n.chess.fen(),squareStyles:e,gameOverDisplay:n.chess.game_over(),whiteHistory:t});break;default:var a=Object(c.a)(n.state.blackHistory);a.push(n.chess.history()[n.chess.history().length-1]),n.setState({currentState:n.chess.fen(),squareStyles:e,gameOverDisplay:n.chess.game_over(),blackHistory:a})}},n.aiMakeMove=function(){return new Promise((function(e){n.setState({currentState:n.chess.fen()}),e()})).then((function(){return n.engineGame().prepareMove()}))},n.changePlayerTurnColor=function(){if(n.chess.game_over())return["gold","gold"];switch(n.chess.turn()){case"b":return n.chess.in_check()?["honeydew","red"]:["honeydew","lawngreen"];case"w":return n.chess.in_check()?["red","honeydew"]:["lawngreen","honeydew"];default:return null}},n.onSquareClick=function(e){var t=n.updateInCheckStyles();n.chess.moves({square:e,verbose:!0}).map((function(e){t["".concat(e.to)]={backgroundColor:"rgba(64,224,208,0.4)"}})),null===n.chess.move({from:n.previousClickedSqure,to:e,promotion:"q"})?n.setState({squareStyles:t}):n.updateMoveHistory(),n.previousClickedSqure=e},n.engineGame=function(e){e=e||{};var t,a="function"===typeof f?f():new Worker(e.stockfishjs||"stockfish.js"),r="function"===typeof f?f():new Worker(e.stockfishjs||"stockfish.js"),s={},o={wtime:3e3,btime:3e3,winc:1500,binc:1500},i=null;function c(e,t){(t||a).postMessage(e)}function l(){var e=("white"===o.clockColor?o.wtime:o.btime)+o.startTime-Date.now();i=setTimeout(l,e%1e3+1)}function u(){for(var e="",t=this.chess.history({verbose:!0}),a=0;a<t.length;++a){var n=t[a];e+=" "+n.from+n.to+(n.promotion?n.promotion:"")}return e}setInterval((function(){t||this.chess.game_over()&&(t=!0)}),500),c("uci");var h=function(){!function(){if(null!==i&&(clearTimeout(i),i=null),o.startTime>0){var e=Date.now()-o.startTime;o.startTime=null,"white"===o.clockColor?o.wtime=Math.max(0,o.wtime-e):o.btime=Math.max(0,o.btime-e)}}();var e="w"===n.chess.turn()?"white":"black";n.chess.game_over()||("black"!==e&&(c("position startpos moves"+u()),c("position startpos moves"+u(),r),c("eval",r),o&&o.wtime?c("go "+(o.depth?"depth "+o.depth:"")+" wtime "+o.wtime+" winc "+o.winc+" btime "+o.btime+" binc "+o.binc):c("go "+(o.depth?"depth "+o.depth:""))),n.chess.history().length>=2&&!o.depth&&!o.nodes&&function(){"w"===this.chess.turn()?(o.wtime+=o.winc,o.clockColor="white"):(o.btime+=o.binc,o.clockColor="black"),o.startTime=Date.now(),l()}())};return r.onmessage=function(e){var t;"uciok"!==(t=e&&"object"===typeof e?e.data:e)&&"readyok"!==t&&t.substr(0,11)},a.onmessage=function(e){var t;if("uciok"===(t=e&&"object"===typeof e?e.data:e))s.engineLoaded=!0;else if("readyok"===t)s.engineReady=!0;else{var a=t.match(/^bestmove ([a-h][1-8])([a-h][1-8])([qrbn])?/);if(a?(n.chess.move({from:a[1],to:a[2],promotion:a[3]}),n.setState({currentState:n.chess.fen()}),h(),c("eval",r)):(a=t.match(/^info .*\bdepth (\d+) .*\bnps (\d+)/))&&(s.search="Depth: "+a[1]+" Nps: "+a[2]),a=t.match(/^info .*\bscore (\w+) (-?\d+)/)){var o=parseInt(a[2],10)*("w"===n.chess.turn()?1:-1);"cp"===a[1]?s.score=(o/100).toFixed(2):"mate"===a[1]&&(s.score="Mate in "+Math.abs(o)),(a=t.match(/\b(upper|lower)bound\b/))&&(s.score=("upper"===a[1]===("w"===n.chess.turn())?"<= ":">= ")+s.score)}}},{start:function(){c("ucinewgame"),c("isready"),s.engineReady=!1,s.search=null,h(),t=!1},prepareMove:function(){h()}}},n.state={currentState:null,squareStyles:{},welcomeDisplay:!1,againstAI:!1,whiteHistory:[],blackHistory:[]},n.chess=new g,n.blackKingPiece={type:"k",color:"b"},n.whiteKingPiece={type:"k",color:"w"},n.previousClickedSqure="",n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.setState({welcomeDisplay:!0})}},{key:"render",value:function(){var e=this,t=this.changePlayerTurnColor(),a=Object(i.a)(t,2),n=a[0],s=a[1],o=this.state.welcomeDisplay?"flex":"none",c="none"===o?"flex":"none";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"welcomeScreen",style:{display:o}},r.a.createElement("p",null," Welcome to Luke's Chess App! :D "),r.a.createElement(d.a,{variant:"dark",size:"lg",className:"againstStockFIsh"},"Play Against StockFish Engine AI (Coming soon)"),r.a.createElement(d.a,{variant:"dark",size:"lg",className:"againstFriendLocally",onClick:function(){e.newGame(!1)}},"Play Against a Friend Locally"),r.a.createElement(d.a,{variant:"dark",size:"lg",className:"againstFriendOnline"},"Play Against a Friend Online (Coming Soon)")),r.a.createElement("div",{className:"gameScreen",style:{display:c}},r.a.createElement("div",{className:"leftBoardPanel"},r.a.createElement(d.a,{variant:"dark",size:"lg",className:"undoButton",onClick:this.undoMove},"Undo Move"),r.a.createElement(d.a,{variant:"dark",size:"lg",className:"resetBoardButton",onClick:function(){e.newGame(!1)}},"Reset Board"),r.a.createElement(d.a,{variant:"dark",size:"lg",className:"newGameButton",onClick:this.displayHomeScreen},"Home")),r.a.createElement("div",{className:"board"},r.a.createElement("div",{className:"opponentIndicatorWrapper"},r.a.createElement("div",{className:"opponentIndicator",style:{backgroundColor:s}},"  ")),r.a.createElement("div",{className:"centerBoardPanel"},r.a.createElement(y.a,{position:this.state.currentState,onDrop:this.onDrop,boardStyle:this.boardStyle,calcWidth:this.calcWidth,squareStyles:this.state.squareStyles,onSquareClick:this.onSquareClick,undo:this.undoCopy})),r.a.createElement("div",{className:"selfIndicatorWrapper"},r.a.createElement("div",{className:"selfIndicator",style:{backgroundColor:n}}," "))),r.a.createElement("div",{className:"rightBoardPanel"},r.a.createElement(p.a,{striped:!0,bordered:!0,hover:!0,variant:"dark"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"White"),r.a.createElement("th",null,"Black"))),r.a.createElement("tbody",null,this.prepareHistory().map((function(e){return r.a.createElement("tr",{key:e[0]},r.a.createElement("td",null,e[0]),r.a.createElement("td",null,e[1]),r.a.createElement("td",null,e[2]))})))))))}},{key:"updateInCheckStyles",value:function(){var e,t={};this.chess.in_check()&&(e="b"===this.chess.turn()?this.get_piece_positions(this.blackKingPiece):this.get_piece_positions(this.whiteKingPiece),t["".concat(e)]={backgroundColor:"red"});return t}}]),a}(r.a.Component);a(45);var k=function(){return r.a.createElement(b,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.cb1e5ee7.chunk.js.map